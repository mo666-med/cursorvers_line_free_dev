name: Restore LINE Daily Brief

on:
  schedule:
    # 2026å¹´2æœˆ1æ—¥ JST 00:00 (UTC 15:00 on Jan 31)
    - cron: '0 15 31 1 *'
  workflow_dispatch:

jobs:
  restore:
    runs-on: ubuntu-latest
    steps:
      - name: Check date and enable workflow
        env:
          GH_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        run: |
          CURRENT_MONTH=$(date -u +%m)
          CURRENT_DAY=$(date -u +%d)
          
          # Feb 1 (or manual trigger)
          if [ "$CURRENT_MONTH" = "02" ] || [ "$CURRENT_MONTH" = "01" -a "$CURRENT_DAY" = "31" ] || [ "${{ github.event_name }}" = "workflow_dispatch" ]; then
            echo "ğŸ“¤ LINE Daily Brief ã‚’æœ‰åŠ¹åŒ–ä¸­..."
            gh workflow enable "LINE Daily Brief" --repo ${{ github.repository }}
            echo "âœ… LINE Daily Brief ãŒæœ‰åŠ¹åŒ–ã•ã‚Œã¾ã—ãŸ"
            
            # è‡ªåˆ†è‡ªèº«ã‚’ç„¡åŠ¹åŒ–
            gh workflow disable "Restore LINE Daily Brief" --repo ${{ github.repository }}
            echo "ğŸ—‘ï¸ å¾©å¸°ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã‚’ç„¡åŠ¹åŒ–ã—ã¾ã—ãŸ"
          else
            echo "â³ ã¾ã ãƒªã‚»ãƒƒãƒˆæ—¥ã§ã¯ã‚ã‚Šã¾ã›ã‚“"
          fi
