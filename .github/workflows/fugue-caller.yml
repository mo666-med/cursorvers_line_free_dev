name: fugue-caller

on:
  issues:
    types: [opened, labeled]
  issue_comment:
    types: [created]
  workflow_dispatch:
    inputs:
      issue_number:
        description: "Issue number to process"
        required: true
        type: string

permissions:
  issues: write
  contents: read

jobs:
  route:
    if: ${{ github.event_name != 'issue_comment' || github.actor != 'github-actions[bot]' }}
    uses: cursorvers/fugue-orchestrator/.github/workflows/fugue-task-router.yml@v1
    with:
      issue_number: "${{ format('{0}', github.event.issue.number || github.event.inputs.issue_number) }}"
    secrets:
      OPENAI_API_KEY: ${{ secrets.OPENAI_API_KEY }}
      ZAI_API_KEY: ${{ secrets.ZAI_API_KEY }}